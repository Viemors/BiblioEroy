<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/tabela.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <title>Dados do livro</title>
    <style>
    @import url('https://fonts.googleapis.com/css2?family=Lexend+Deca:wght@100..900&display=swap');
  </style>
</head>

<body>
    <%-include("../partials/header")%>
    <%-include('../partials/navbar') %>
    <% if (error && error.length) { %> <!-- aq ele verifica se  tem uum error no array de erros, isso é coisa do express -->
                <div class="flash flash-error" style="color: red; text-align:center;">
                    <% error.forEach(function(msg){ %>
                    <p><%= msg %></p>
                    <% }) %>
                </div> <!--no ejs vc acessa error (que é res.locals.error) -->
            <% } %>
            <% if (success && success.length) { %>
                <div class="flash flash-success" style="color: green; text-align:center;">
                    <% success.forEach(function(msg){ %>
                        <p><%= msg %></p>
                    <% }) %>
                </div>
            <% } %>
      <main>
        <div class="container mt-4">
            
                <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                <!-- Card genérico para todos os emprestimos do banco de dados -->
                <%for(let i=0; i<Object.keys(emprestimos).length; i++) {%>
                  <div class="col">
                    <div class="card h-100">
                      <form action="/atualizarEmprestimo" method="POST" class="card-body">
                        <input type="hidden" name="titulo" value="<%=emprestimos[i].tituloLivro%>">
                        <input type="hidden" name="titulo" value="<%=emprestimos[i].tituloLivro%>">
                        <h5 class="card-title">
                          <%=emprestimos[i].tituloLivro%>
                        </h5>
                        <input type="hidden" name="nomeLeitor" value="<%=emprestimos[i].nomeLeitor%>">
                        <p class="card-text">Usuário: <%=emprestimos[i].nomeLeitor%>
                        </p>
                        <input type="hidden" name="datainicial" value="<%=emprestimos[i].datainicial%>">
                        <p class="card-text">inicio: <%=emprestimos[i].datainicial%>
                        </p>
                        <input type="hidden" name="datafinal" value="<%=emprestimos[i].datafinal%>">
                        <p class="card-text">fim: <%=emprestimos[i].datafinal%>
                        </p>
                        <input type="hidden" name="nomeAdm" value="<%=emprestimos[i].nomeAdm%>" class="nomeAdm" required>
                        <button type="submit" class="btn btn-outline-primary btn-curtir" id="button"> Renovar </button>
                      </form>
                    </div>
                  </div>
                  <%}%>

                  <!-- Card genérico para todos as solicitações do banco de dados -->
                <%for(let i=0; i<Object.keys(resultados).length; i++) {%>
                  <div class="col">
                    <div class="card h-100">
                      <form action="/addEmprestimo" method="POST" class="card-body">
                        <input type="hidden" name="nomeLeitor" value="<%=resultados[i].username%>">
                        <h5 class="card-title">
                          Usuário: <%=resultados[i].username%>
                        </h5>
                        <input type="hidden" name="titulo" value="<%=livros[i][0].titulo%>">
                        <p class="card-text">Titulo: <%=livros[i][0].titulo%>
                        </p>
                        <input type="hidden" name="autor" value="<%=livros[i][0].autor%>">
                        <p class="card-text">autor: <%=livros[i][0].autor%>
                        </p>
                        <input type="hidden" name="categoria" value="<%=livros[i][0].categoria%>">
                        <p class="card-text">categoria: <%=livros[i][0].categoria%>
                        </p>
                        <input type="hidden" name="descricao" value="<%=livros[i][0].descricao%>">
                        <p class="card-text">descricao: <%=livros[i][0].descricao%>
                        </p>
                        <input type="hidden" name="nomeAdm" value="alguem" class="nomeAdm" required>
                        <button type="submit" class="btn btn-outline-primary btn-curtir" id="button"> Emprestar </button>
                      </form>
                    </div>
                  </div>
                  <%}%>
              </div>

        </div>
</main>
        <%-include('../partials/footer') %>

</body>

</html>